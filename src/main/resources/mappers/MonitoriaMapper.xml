<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="dao.MonitoriaDao">
    <resultMap type= 'Monitoria' id='monitoriaResult'>
        <id property='id' column='id_Monitoria'/>
        <result property='ip' column='ip' />
        <result property='observaciones' column='observaciones' />
        <result property='fecha' column='fecha' />
        <association property='franja' javaType='FranjaId' resultmap='franjaResult'/>
     </resultMap>
     <resultMap type='Tema' id='temaResult'>
         <id property='id' column='TemaID'/>
         <result poperty='name' column='name'/>
         
     </resultMap>
     <resultMap type= 'Estudiante' id='estudiateResult'>
         <id property='id' column='id_Carnet'/>
     <resultMap type= 'Estudiante' id='estudiateRes
         <result property='nombre' column='nombre_Es'/>
         <result property='apellido' column='apellido_Es'/>
     </resultMap>
     <resultMap type= 'FranjaHoraio' id='franjaResult'>
        <id property='id' column='id_Franja_Horario'/>
        <result property='dia_mon' column='dia_mon' />
        <result property='hora' column='hora' />
     </resultMap>
     <select parameterType='map' id='ConsultarMonitoria' resultMap='monitoriaResult'>
        select id_Monitoria, ip,observaciones,fecha,id_Carnet,nombre_Es,apellido_Es,TemaID 
        from Monitoria, Estudiante,Asistencia,Tema
        where id_monitoria=#{idmo} and id_Carnet=Estudiante_id_Carnet and Monitoria_id_Monitoria=id_Monitoria and TemaID=Tema_TemaID
     </select> 
     <insert id='agregarMonitoria'>
         insert into Monitoria(ip,observaciones,Fanja_id)
         values(#{ip},#{obsv},null)
         insert into Estudiante
         values(#{idcar},null,null)
         insert into Asistencia 
         values(#{idcar},SELECT max(id_Mon) FROM monitoria,#{tem})
         insert into Tema
         values(#{tem})
     </insert>
 </mapper>
